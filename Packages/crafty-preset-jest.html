<!DOCTYPE html>
<html class="no-js" lang="en">
<head>
    <title>crafty-preset-jest - Crafty</title>
    <meta name="description" content="The task runner that binds them all">
    <meta name="author" content="Swissquote Bank SA">
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <link rel="icon" href="../themes/swissquote/img/favicon.png" type="image/x-icon">

    <!-- Mobile -->
    <meta name="apple-mobile-web-app-capable" content="yes" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- Font -->
    
    <!-- CSS -->
    <link href='../themes/swissquote/css/theme.min.css' rel='stylesheet' type='text/css'>
    
    <!--[if lt IE 9]>
    <script src="../themes/daux/js/html5shiv-3.7.3.min.js"></script>
    <![endif]-->
</head>
<body class=" ">
    <div class="Columns content">
    <aside class="Columns__left Collapsible">
        <a class="Brand" href="../index.html">Crafty</a>

        <input class="Collapsible__trigger" id="ac-toc" name="accordion-toc" title="Toggle Menu" type="checkbox">
        <label class="Collapsible__label" for="ac-toc">Toggle Menu</label>

        <div class="Collapsible__content">
            <!-- Navigation -->
            <ul class='Nav'><li class='Nav__item '><a href="../Getting_Started.html">Getting Started</a></li><li class='Nav__item  has-children'><a href="../Use_Cases/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Use Cases</a><ul class='Nav'><li class='Nav__item '><a href="../Use_Cases/Compiling_CSS.html">Compiling CSS</a></li><li class='Nav__item '><a href="../Use_Cases/Compiling_JavaScript.html">Compiling JavaScript</a></li><li class='Nav__item '><a href="../Use_Cases/Compiling_TypeScript.html">Compiling TypeScript</a></li><li class='Nav__item '><a href="../Use_Cases/Compressing_Images.html">Compressing Images</a></li><li class='Nav__item '><a href="../Use_Cases/Testing_your_code.html">Testing your code</a></li></ul></li><li class='Nav__item  has-children'><a href="../User_Guides/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>User Guides</a><ul class='Nav'><li class='Nav__item '><a href="../User_Guides/Configuring_the_build_in_a_blank_project.html">Configuring the build in a blank project</a></li><li class='Nav__item '><a href="../User_Guides/Configuring_the_build_in_a_maven_project.html">Configuring the build in a maven project</a></li><li class='Nav__item '><a href="../User_Guides/Create_a_configuration_file.html">Create a configuration file</a></li><li class='Nav__item '><a href="../User_Guides/crafty.config.js_Available_Options.html">crafty.config.js Available Options</a></li><li class='Nav__item '><a href="../User_Guides/Developing_Faster_with_Crafty_watch.html">Developing Faster with Crafty watch</a></li></ul></li><li class='Nav__item Nav__item--open has-children'><a href="../Packages/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>Packages</a><ul class='Nav'><li class='Nav__item  has-children'><a href="../Packages/crafty/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>crafty</a><ul class='Nav'><li class='Nav__item '><a href="../Packages/crafty/Anatomy_of_a_preset.html">Anatomy of a preset</a></li><li class='Nav__item '><a href="../Packages/crafty/The_Crafty_instance.html">The Crafty instance</a></li></ul></li><li class='Nav__item '><a href="../Packages/crafty-runner-gulp.html">crafty-runner-gulp</a></li><li class='Nav__item '><a href="../Packages/crafty-runner-rollup.html">crafty-runner-rollup</a></li><li class='Nav__item '><a href="../Packages/crafty-runner-webpack.html">crafty-runner-webpack</a></li><li class='Nav__item  has-children'><a href="../Packages/crafty-preset-babel/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>crafty-preset-babel</a><ul class='Nav'><li class='Nav__item '><a href="../Packages/crafty-preset-babel/ESLint_IDE_Integration.html">ESLint IDE Integration</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-babel/JavaScript_Features.html">JavaScript Features</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-babel/JavaScript_Linting.html">JavaScript Linting</a></li></ul></li><li class='Nav__item '><a href="../Packages/crafty-preset-images.html">crafty-preset-images</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-images-simple.html">crafty-preset-images-simple</a></li><li class='Nav__item Nav__item--active'><a href="../Packages/crafty-preset-jest.html">crafty-preset-jest</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-maven.html">crafty-preset-maven</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-polyfills.html">crafty-preset-polyfills</a></li><li class='Nav__item  has-children'><a href="../Packages/crafty-preset-postcss/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>crafty-preset-postcss</a><ul class='Nav'><li class='Nav__item '><a href="../Packages/crafty-preset-postcss/CSS_Features.html">CSS Features</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-postcss/CSS_Linting.html">CSS Linting</a></li></ul></li><li class='Nav__item '><a href="../Packages/crafty-preset-react.html">crafty-preset-react</a></li><li class='Nav__item  has-children'><a href="../Packages/crafty-preset-typescript/index.html" class="folder"><i class="Nav__arrow">&nbsp;</i>crafty-preset-typescript</a><ul class='Nav'><li class='Nav__item '><a href="../Packages/crafty-preset-typescript/Getting_Started_with_TypeScript.html">Getting Started with TypeScript</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-typescript/TypeScript_Features.html">TypeScript Features</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-typescript/TypeScript_Linting.html">TypeScript Linting</a></li><li class='Nav__item '><a href="../Packages/crafty-preset-typescript/TypeScript_Typings.html">TypeScript Typings</a></li></ul></li><li class='Nav__item '><a href="../Packages/babel-preset-swissquote.html">babel-preset-swissquote</a></li><li class='Nav__item '><a href="../Packages/eslint-plugin-swissquote.html">eslint-plugin-swissquote</a></li><li class='Nav__item '><a href="../Packages/postcss-swissquote-preset.html">postcss-swissquote-preset</a></li><li class='Nav__item '><a href="../Packages/stylelint-config-swissquote.html">stylelint-config-swissquote</a></li></ul></li><li class='Nav__item '><a href="../CLI.html">CLI</a></li><li class='Nav__item '><a href="../Troubleshooting.html">Troubleshooting</a></li><li class='Nav__item '><a href="../Why.html">Why</a></li></ul>

            <div class="Links">
                                    <hr class=Separator />
                    <ul class=Nav>
                                            <li class=Nav__item>
                        <a href="https://medium.com/swissquote-engineering" target="_blank">Technical blog</a>
                        </li>   
                                            <li class=Nav__item>
                        <a href="https://swissquote.com/" target="_blank">Swissquote</a>
                        </li>   
                                            <li class=Nav__item>
                        <a href="http://github.com/swissquote/crafty" target="_blank">GitHub</a>
                        </li>   
                                        </ul>
                
                            </div>
            <hr class=Separator />
            <div class=Copyright>
                © 2017 Swissquote Bank SA. Powered by Daux.io.
            </div>
        </div>
    </aside>
    <div class="Columns__right Columns__right--full">
        <div class="Columns__right__content">
            <div class="doc_content">
                <article class="Page">

    <div class="Page__header">
        <h1><a href="../Packages/index.html">Packages</a> <svg class="Page__header--separator" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 477.175 477.175"><path d="M360.73 229.075l-225.1-225.1c-5.3-5.3-13.8-5.3-19.1 0s-5.3 13.8 0 19.1l215.5 215.5-215.5 215.5c-5.3 5.3-5.3 13.8 0 19.1 2.6 2.6 6.1 4 9.5 4 3.4 0 6.9-1.3 9.5-4l225.1-225.1c5.3-5.2 5.3-13.8.1-19z"/></svg> <a href="../Packages/crafty-preset-jest.html">crafty-preset-jest</a></h1>
                    </div>

    <div class="s-content">
        <table>
<tr><th>Compatible Runners</th><td>
<p>Not tied to any runner</p>
</td></tr>
<tr><th>Linters</th><td>
<p>N/A</p>
</td></tr>
<tr><th>Commands</th><td>
<ul>
<li>
<code>test</code>: Jest integrates itself with the <code>crafty test</code> command</li>
</ul>
</td></tr>
<tr><th>Related presets</th><td>
<ul>
<li>
<a href="crafty-preset-babel/index.html">Babel</a>
</li>
<li>
<a href="crafty-preset-typescript/index.html">TypeScript</a>
</li>
</ul>
</td></tr>
</table>
<p>Crafty provides a preset that will run <a href="https://facebook.github.io/jest/" class="external">Jest</a>
once <code>crafty test</code> is executed.</p>
<p>It adds safe defaults to be able to run your tests with your configuration and
provides an extension hook that allows you and other presets to extend its
configuration.</p>
<p>Jest is a Node-based runner. This means that the tests always run in a Node
environment and not in a real browser. This lets us enable fast iteration speed
and prevent flakiness.</p>
<p>While Jest provides browser global variables such as <code>window</code> thanks to
<a href="https://github.com/tmpvar/jsdom" class="external">jsdom</a>, they are approximations of the real
browser behavior. Jest is intended to be used for unit tests of your logic and
your components rather than the DOM quirks.</p>
<p>We recommend that you use a separate tool for browser end-to-end tests if you
need them.</p>
<div class="TableOfContentsContainer">
    <h4 class="TableOfContentsContainer__title">Table of Contents</h4>
    <div class="TableOfContentsContainer__content">
        <ul class="TableOfContents">
<li>
<p><a href="#page_File-name-Conventions">File name Conventions</a></p>
</li>
<li>
<p><a href="#page_section_2"><code>crafty test</code></a></p>
</li>
<li>
<p><a href="#page_Writing-Tests">Writing Tests</a></p>
</li>
<li>
<p><a href="#page_Testing-Components">Testing Components</a></p>
</li>
<li>
<p><a href="#page_Focusing-and-Excluding-Tests">Focusing and Excluding Tests</a></p>
</li>
<li>
<p><a href="#page_Coverage-Reporting">Coverage Reporting</a></p>
</li>
<li>
<p><a href="#page_Snapshot-Testing">Snapshot Testing</a></p>
</li>
<li>
<p><a href="#page_Extending-the-configuration">Extending the configuration</a></p>
</li>
</ul>    </div>
</div>
<h2 id="page_File-name-Conventions">File name Conventions</h2>
<p>Jest will look for test files with any of the following popular naming
conventions:</p>
<ul>
<li>Files with <code>.js</code> suffix in <code>__tests__</code> folders.</li>
<li>Files with <code>.test.js</code> suffix.</li>
<li>Files with <code>.spec.js</code> suffix.</li>
</ul>
<p>The <code>.test.js</code> / <code>.spec.js</code> files (or the <code>__tests__</code> folders) can be located at
any depth under the <code>src</code> top level folder.</p>
<p>We recommend to put the test files (or <code>__tests__</code> folders) next to the code
they are testing so that relative imports appear shorter. For example, if
<code>App.test.js</code> and <code>App.js</code> are in the same folder, the test needs to <code>import App from './App'</code> instead of a long relative path.</p>
<blockquote>
<p>Using <a href="crafty-preset-babel/index.html"><code>crafty-preset-babel</code></a> will add
<code>jsx</code> as a supported test file extension and
<a href="crafty-preset-typescript/index.html"><code>crafty-preset-typescript</code></a> will
add the support for <code>ts</code> and <code>tsx</code></p>
</blockquote>
<h2 id="page_section_2"><code>crafty test</code></h2>
<p>Running <code>crafty test</code> will run all test and exit. But you can use any option
provided by Jest itself.</p>
<p>For example <code>crafty test --watch</code> will run your tests in watch mode. This mode
will run all your tests once and once it's done will wait for code or test
changes to re-run the concerned tests.</p>
<h2 id="page_Writing-Tests">Writing Tests</h2>
<p>To create tests, add <code>it()</code> (or <code>test()</code>) blocks with the name of the test and
its code. You may optionally wrap them in <code>describe()</code> blocks for logical
grouping but this is neither required nor recommended.</p>
<p>Jest provides a built-in <code>expect()</code> global function for making assertions. A
basic test could look like this:</p>
<pre><code class="language-js">import sum from &quot;./sum&quot;;

it(&quot;sums numbers&quot;, () =&gt; {
  expect(sum(1, 2)).toEqual(3);
  expect(sum(2, 2)).toEqual(4);
});
</code></pre>
<p>All <code>expect()</code> matchers supported by Jest are
<a href="http://facebook.github.io/jest/docs/expect.html" class="external">extensively documented here</a>.<br />
You can also use
<a href="http://facebook.github.io/jest/docs/expect.html#tohavebeencalled" class="external"><code>jest.fn()</code> and <code>expect(fn).toBeCalled()</code></a>
to create “spies” or mock functions.</p>
<h2 id="page_Testing-Components">Testing Components</h2>
<p>A broad spectrum of component testing techniques exists. They range from a
“smoke test” verifying that a component renders without throwing, to shallow
rendering and testing some of the output, to full rendering and testing
component lifecycle and state changes.</p>
<p>Different projects choose different testing trade-offs based on how often
components change, and how much logic they contain. If you haven’t decided on a
testing strategy yet, we recommend that you start with creating simple smoke
tests for your components:</p>
<pre><code class="language-js">import React from &quot;react&quot;;
import ReactDOM from &quot;react-dom&quot;;
import App from &quot;./App&quot;;

it(&quot;renders without crashing&quot;, () =&gt; {
  const div = document.createElement(&quot;div&quot;);
  ReactDOM.render(&lt;App /&gt;, div);
});
</code></pre>
<p>This test mounts a component and makes sure that it didn’t throw during
rendering. Tests like this provide a lot value with little effort so they are
great as a starting point, and this is the test you will find in
<code>src/App.test.js</code>.</p>
<p>When you encounter bugs caused by changing components, you will gain a deeper
insight into which parts of them are worth testing in your application. This
might be a good time to introduce more specific tests asserting specific
expected output or behavior.</p>
<p>If you’d like to test components in isolation from the child components they
render, we recommend using
<a href="http://airbnb.io/enzyme/docs/api/shallow.html" class="external"><code>shallow()</code> rendering API</a> from
<a href="http://airbnb.io/enzyme/" class="external">Enzyme</a>. To install it, run:</p>
<pre><code class="language-sh">npm install --save enzyme react-test-renderer
</code></pre>
<p>You can write a smoke test with it too:</p>
<pre><code class="language-js">import React from &quot;react&quot;;
import { shallow } from &quot;enzyme&quot;;
import App from &quot;./App&quot;;

it(&quot;renders without crashing&quot;, () =&gt; {
  shallow(&lt;App /&gt;);
});
</code></pre>
<p>Unlike the previous smoke test using <code>ReactDOM.render()</code>, this test renders
<code>&lt;App&gt;</code> but doesn’t go deeper. For example, even if <code>&lt;App&gt;</code> itself renders a
<code>&lt;Button&gt;</code> that throws, this test will pass. Shallow rendering is great for
isolated unit tests, but you may still want to create some full rendering tests
to ensure the components integrate as expected. Enzyme supports
<a href="http://airbnb.io/enzyme/docs/api/mount.html" class="external">full rendering with <code>mount()</code></a>,
and you can also use it for testing state changes and component lifecycle.</p>
<p>You can read the <a href="http://airbnb.io/enzyme/" class="external">Enzyme documentation</a> for more
testing techniques. Enzyme documentation uses Chai and Sinon for assertions but
you don’t have to use them because Jest provides built-in <code>expect()</code> and
<code>jest.fn()</code> for spies.</p>
<p>Here is an example from Enzyme documentation that asserts specific output,
rewritten to use Jest matchers:</p>
<pre><code class="language-js">import React from &quot;react&quot;;
import { shallow } from &quot;enzyme&quot;;
import App from &quot;./App&quot;;

it(&quot;renders welcome message&quot;, () =&gt; {
  const wrapper = shallow(&lt;App /&gt;);
  const welcome = &lt;h2&gt;Welcome to React&lt;/h2&gt;;
  // expect(wrapper.contains(welcome)).to.equal(true);
  expect(wrapper.contains(welcome)).toEqual(true);
});
</code></pre>
<p>All Jest matchers are
<a href="http://facebook.github.io/jest/docs/expect.html" class="external">extensively documented here</a>.</p>
<p>You might find <a href="https://github.com/blainekasten/enzyme-matchers" class="external">jest-enzyme</a>
helpful to simplify your tests with readable matchers. The above <code>contains</code> code
can be written simpler with jest-enzyme.</p>
<pre><code class="language-js">expect(wrapper).toContainReact(welcome);
</code></pre>
<p>To enable this, install <code>jest-enzyme</code>:</p>
<pre><code class="language-sh">npm install --save jest-enzyme
</code></pre>
<h2 id="page_Focusing-and-Excluding-Tests">Focusing and Excluding Tests</h2>
<p>You can replace <code>it()</code> with <code>xit()</code> to temporarily exclude a test from being
executed.<br /> Similarly, <code>fit()</code> lets you focus on a specific test without
running any other tests.</p>
<h2 id="page_Coverage-Reporting">Coverage Reporting</h2>
<p>Jest has an integrated coverage reporter that works well with EcmaScript 2015+
and requires no configuration.<br /> Run <code>crafty test --coverage</code> to include a
coverage report like this:</p>
<p><img src="http://i.imgur.com/5bFhnTS.png" alt="coverage report" /></p>
<p>Note that tests run much slower with coverage. We recommend to run it separately
from your normal workflow.</p>
<h2 id="page_Snapshot-Testing">Snapshot Testing</h2>
<p>Snapshot testing is a feature of Jest that automatically generates text
snapshots of your components and saves them on the disk so if the UI output
changes, you get notified without manually writing any assertions on the
component output.
<a href="http://facebook.github.io/jest/blog/2016/07/27/jest-14.html" class="external">Read more about snapshot testing.</a></p>
<h2 id="page_Extending-the-configuration">Extending the configuration</h2>
<p>Each preset and <code>crafty.config.js</code> can define the <code>jest(crafty, options)</code>
function to override Jest's configuration.</p>
<pre><code class="language-javascript">const path = require(&quot;path&quot;);
const MODULES = path.join(__dirname, &quot;..&quot;, &quot;node_modules&quot;);

module.exports = {
  /**
   * Represents the extension point for rollup configuration
   * @param {Crafty} crafty - The instance of Crafty.
   * @param {Object} options - The Jest configuration object
   */
  jest(crafty, options) {
    // Adds this directory to resolve modules
    options.moduleDirectories.push(MODULES);

    // Add a transformer for TypeScript
    options.transform[&quot;^.+\\.tsx?$&quot;] = require.resolve(
      &quot;ts-jest/preprocessor.js&quot;
    );

    // Add file extensions to resolve imports
    options.moduleFileExtensions.push(&quot;ts&quot;);
    options.moduleFileExtensions.push(&quot;tsx&quot;);
  }
};
</code></pre>
<p>The full list of available configuration option is available
<a href="https://facebook.github.io/jest/docs/en/configuration.html" class="external">on the official website</a>.</p>
    </div>

        <nav>
        <ul class="Pager">
            <li class=Pager--prev><a href="../Packages/crafty-preset-images-simple.html">Previous</a></li>            <li class=Pager--next><a href="../Packages/crafty-preset-maven.html">Next</a></li>        </ul>
    </nav>
    </article>

            </div>
        </div>
    </div>
</div>
    
    <!-- jQuery -->
    <script src="../themes/daux/js/jquery-1.11.3.min.js"></script>

    <!-- prismjs -->
    <script src="../themes/swissquote/js/prismjs.1.9.0.min.js"></script>

    <!-- JS -->
    
    <script src="../themes/daux/js/daux.js"></script>

    
</body>
</html>
